<head>
  <title>Sink or Submit!</title>
</head>

<body>
	<!-- Put if block around this to only show the user area when there's a user logged in
	     otherwise, the login area appears in the main wrapper div -->
	{{#if currentUser}}
	<div class="logout">
		{{> loginButtons}}
	</div>
	{{/if}}
	<div class="wrapper">
		<div class="header">
			<div calss="header-center">
				<h1>Sink or Submit!</h1>
			</div>
		</div>
		<div class="clear"><br /></div>

		{{#if currentUser}}
		<div class="user" id="user" style="border-bottom-right-radius:{{userRadius}}px">
			<div class="userdata">
				<h1>{{currentUser.username}} ({{userScore}})</h1>
				{{> userGroup}}
				<!-- Get a different trophy picture? -->
				{{> trophy}}

				<br />

				{{> statUpdate}}
				{{> userStats}}
				<!--{{> statBar}}-->
				<br />
				{{> leaveGroup}}
				<br />
				{{#if isAdmin}}
				{{> groupAdmin}}
				{{/if}}
			</div>
		</div>
		<div class="leaderboard" id="leaderboard">
				{{> leaderboard}}
		</div>
		{{else}}
		<!-- Next up: put a login area here when a user isn't logged in -->
		<div class=login>
			<h1>You must be logged in to use this feature</h1>
			{{> loginButtons}}
		</div>
		{{/if}}

		<div class="clear"></div>
		<div class="notice">
			<p>
				Sink or Submit is based on a game invented by <a href="https://twitter.com/rachaelkjones" target="_blank">@rachaelkjones</a> and given minor internet notoriety by 
				<a href="https://twitter.com/ghostwritingcow" target="_blank">@ghostwritingcow</a>.
				<br />
				It was developed by <a href="https://twitter.com/hbbisenieks" target="_blank">@HBBisenieks</a>.
			</p>
			<p>
				Sink or Submit is released under an MIT license. The source code is available on <a href="https://github.com/hbbisenieks/submissions-game/" target="_blank">GitHub</a>. Fork it!
			</p>
		</div>
	</div>
</body>

<template name="userGroup">
	{{#if inGroup}}
		<h4>{{groupName.groupDescription}}</h4>
	{{else}}
		<p>You aren't in a group yet. What would you like to do?</p>
		{{> joinGroup}}
	{{/if}}
</template>

<template name="joinGroup">
	<form>
		<input type="radio" name="group-select" value="join">Join an Existing Group<br />
		<input type="radio" name="group-select" value="create">Create a New Group
	</form>
	<div class="clear"><br /></div>
	{{#if join}}
	  <div class="groupleft">
		  Group ID:<br />
		  Group Secret:
	  </div>
	  <div class="groupright">
		  <form class="joinGroup">
		  	<input type="text" name="groupName" placeholder="Group id" required /><br />
			<input type="password" name="groupSecret" placeholder="Group secret" required /><br />
			<input type="submit" value="Join Group" />
		  </form>
	  </div>
	{{else}}
	  {{#if create}}
	    <div class="groupleft">
		    Group ID:<br />
		    Group Display Name:<br />
		    Group Secret:<br />
		    Re-enter Secret:
	    </div>
	    <div class="groupright">
		    <form class="createGroup">
			    <input type="text" name="groupName" placeholder="New group id" required /><br />
			    <input type="text" name="groupDescription" placeholder="New group display-name" required /><br />
			    <input type="password" name="groupSecret" placeholder="New group secret" required /><br />
			    <input type="password" name="secretConfirm" placeholder="Re-enter group secret" required /><br />
			    <input type="submit" value="Create group"/>
		    </form>
	    </div>
	  {{else}}
	  {{/if}}
	{{/if}}
	<div class="clear"></div>
</template>

<template name="statUpdate">
	<button class="subPlus">S +</button>
	<button class="rejPlus">R +</button>
	<button class="accPlus">A +</button>
	<button class="wdPlus">W +</button>
	<br />
	<button class="subMinus">&nbsp;S -</button>
	<button class="rejMinus">&nbsp;R -</button>
	<button class="accMinus">&nbsp;A -</button>
	<button class="wdMinus">&nbsp;W -</button>
</template>

<template name="trophy">
	{{#if leading}}
		<img src='trophy.png' alt='Current Leader!' height='40%' width='40%' />
	{{/if}}
</template>

<template name="userStats">
	<p>Stats</p>
	<ul>
		<li>Submissions: {{userSubs}}</li>
		<li>Rejections: {{userRejections}}</li>
		<li>Acceptances: {{userAccept}}</li>
		<li>Withdrawals: {{userWithdraw}}</li>
	</ul>
	<p>Score: {{userScore}}</p>
</template>

<template name="statBar">
<!-- Not working right now, maybe replace with pie chart? -->
	<div class="statbar">
		<div class="rejs" style="width:{{rejWidth}}%"></div>
		<div class="accs" style="width:{{accWidth}}%"></div>
	</div>
</template>

<template name="leaveGroup">
	{{#if inGroup}}
	  <button class="leave">Leave group</button>
	{{/if}}
</template>

<template name="groupAdmin">
	<h1>A D M I N !</h1>
	<select class="members">
		{{#each writer}}
		<!-- Return list of users with * next to the names of all other group admins -->
		<option value="{{username}}" name="name">{{username}}{{#if groupAdmin}}*{{/if}}</option>
		{{/each}}
	</select>
	<br />
	<button class="makeAdmin">Grant Admin Rights</button>
	<button class="kick">Kick User</button>
</template>

<template name="leaderboard">
	<h1>Leaderboard</h1>
	<div class="clear"></div>
	<div class="score">
			{{#each writer}}
			<p>{{score}}</p>
			{{/each}}
	</div>
	<div class="stats">
			{{#each writer}}
			<p>{{subs}}/{{rejs}}/{{accs}}/{{wds}}</p>
			{{/each}}
	</div>
	<div class="name">
			{{#each writer}}
			<p>{{username}}</p>
			{{/each}}
	</div>
</template>
